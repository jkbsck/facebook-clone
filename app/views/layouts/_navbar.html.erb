<header class="navbar-main">
  <div class="navbar-wrapper">
    <div class="navbar-user">
    
    </div>
    <div class="navbar-actions">
    
    </div>
  </div>
</header>


<div class="navbar-container">
  <!-- This form searches for users and return results to same url -->
  <%= form_with(url: "#{request.env["PATH_INFO"]}", method: 'get', local: true) do %>
    <%= hidden_field_tag :id, params[:id] if params.key?(:id) %>
    <%= text_field_tag(:search) %>    
    <%= submit_tag("Find Friends", class: "find-friends-button") %>
  <% end %>
  <% if params.key?(:search) %>
    <% @users_searched = User.search(params[:search]) %>
    <div id="search-users-container-results" class="search-users-container-results">
      <div class="search-users-container-results-child">
        <% @users_searched.each do |user| %>
          <% unless current_user == user %>
            <div class="searched-user-container">
              <%= user.username %>
              <% unless current_user == user || %>
                <% current_user.friend_requests_as_requestor.any? { |e| e.receiver == user } || %>
                <% (FriendRequest.all.any? { |r| r.requestor.id == user.id && r.receiver.id == current_user.id }) %>
                <div class="searched-user-button-container">
                  <%= render "friend_requests/form", user: user %>
                </div>
              <% end %>         
            </div>
          <% end %>
        <% end %>
        <!-- button for hiding div with search results -->
          <input type="submit", value="Close" onclick="hideDiv()" class="close-searched-users-button">
          <script>
            function hideDiv() {
              document.getElementById("search-users-container-results").style.display = "none";
            }
          </script>
      </div>
    </div>
  <% end %>

  <!-- container with pending friend requests -->
  <div class="friend-requests-show-button-container">
    <input type="submit", value="Friend Requests" onclick="friendRequestsDiv()" class="friend-requests-show-button">
    <script>
      function friendRequestsDiv() {
        div = document.getElementById("friend-requests-show-container")
        if(div.style.display == "block"){
          div.style.display = "none";
        }else{
          div.style.display = "block";
        }
        document.getElementById("search-users-container-results").style.display = "none";
      }
    </script>
  </div>
  <div id="friend-requests-show-container" class="index-friend-requests-container">
    <%= render "friend_requests/index", friend_requests_accepted: @friend_requests_accepted, friend_requests_pending: @friend_requests_pending %>
  </div>
</div>
